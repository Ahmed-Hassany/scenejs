/*!
 * Copyright (c) 2018 Daybrush
 * license: MIT
 * author: Daybrush
 * repository: https://github.com/daybrush/scenejs.git
 * @version 0.11.0
 */
!function(e,t){"object"==typeof exports&&"object"==typeof module?module.exports=t():"function"==typeof define&&define.amd?define("Scene",[],t):"object"==typeof exports?exports.Scene=t():e.Scene=t()}(window,function(){return function(e){var t={};function __webpack_require__(r){if(t[r])return t[r].exports;var i=t[r]={i:r,l:!1,exports:{}};return e[r].call(i.exports,i,i.exports,__webpack_require__),i.l=!0,i.exports}return __webpack_require__.m=e,__webpack_require__.c=t,__webpack_require__.d=function(e,t,r){__webpack_require__.o(e,t)||Object.defineProperty(e,t,{configurable:!1,enumerable:!0,get:r})},__webpack_require__.r=function(e){Object.defineProperty(e,"__esModule",{value:!0})},__webpack_require__.n=function(e){var t=e&&e.__esModule?function(){return e.default}:function(){return e};return __webpack_require__.d(t,"a",t),t},__webpack_require__.o=function(e,t){return Object.prototype.hasOwnProperty.call(e,t)},__webpack_require__.p="",__webpack_require__(__webpack_require__.s=0)}([function(e,t,r){"use strict";var i=_interopRequireDefault(r(1)),n=_interopRequireDefault(r(16)),o=_interopRequireDefault(r(18)),a=r(19),s=r(9),u=_interopRequireDefault(r(6)),f=_interopRequireDefault(r(3));function _interopRequireDefault(e){return e&&e.__esModule?e:{default:e}}i.default.LINEAR=s.LINEAR,i.default.EASE=s.EASE,i.default.EASE_IN=s.EASE_IN,i.default.EASE_OUT=s.EASE_OUT,i.default.EASE_IN_OUT=s.EASE_IN_OUT,i.default.cubicBezier=u.default,i.default.SceneItem=n.default,i.default.Frame=o.default,i.default.Animator=f.default,i.default.TRANSFORM=a.TRANSFORM,i.default.FILTER=a.FILTER,i.default.ANIMATION=a.ANIMATION,i.default.KEYFRAMES=a.KEYFRAMES,e.exports=i.default},function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var i=function(){function defineProperties(e,t){for(var r=0;r<t.length;r++){var i=t[r];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(e,i.key,i)}}return function(e,t,r){return t&&defineProperties(e.prototype,t),r&&defineProperties(e,r),e}}(),n=function get(e,t,r){null===e&&(e=Function.prototype);var i=Object.getOwnPropertyDescriptor(e,t);if(void 0===i){var n=Object.getPrototypeOf(e);return null===n?void 0:get(n,t,r)}if("value"in i)return i.value;var o=i.get;return void 0!==o?o.call(r):void 0},o=_interopRequireDefault(r(2)),a=_interopRequireDefault(r(16)),s=r(19),u=r(9);function _interopRequireDefault(e){return e&&e.__esModule?e:{default:e}}var f=function(e){function Scene(){return function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,Scene),function(e,t){if(!e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!t||"object"!=typeof t&&"function"!=typeof t?e:t}(this,(Scene.__proto__||Object.getPrototypeOf(Scene)).apply(this,arguments))}return function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}(Scene,o.default),i(Scene,[{key:"newItem",value:function(e,t){if(this.items[e])return this.items[e];var r=new a.default;return this.setItem(e,r),r.setOptions(t),r}},{key:"setSelector",value:function(e){for(var t in e){var r=e[t],i=this.getItem(r);i&&i.setSelector(t)}return this}},{key:"load",value:function(e,t){if(n(Scene.prototype.__proto__||Object.getPrototypeOf(Scene.prototype),"load",this).call(this,e,t),!this.options.selector)return this;var r=void 0,i=void 0;for(r in e)"options"!==r&&(i=this.getItem(r))&&i.setSelector(r);return this}},{key:"exportCSS",value:function(){var e=this.items,t=this.getDuration();for(var r in t&&isFinite(t)||(t=0),e){e[r].exportCSS(t,this.state)}return this}},{key:"playCSS",value:function(){var e=this,t=!(arguments.length>0&&void 0!==arguments[0])||arguments[0],r=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};if(!s.ANIMATION||"running"===this.getPlayState())return this;t&&this.exportCSS();var i=this.items,n=void 0;for(var o in i){var a=i[o];a.playCSS(!1,r),a._animationend&&(n=a)}return n?(this._animationend=function(t){e.end()},this._animationiteration=function(t){var r=t.currentTime,i=t.iterationCount;e.state.currentTime=r,e.setCurrentIterationCount(i)},this._animationItem=n,n.on("ended",this._animationend),n.on("iteration",this._animationiteration),this.setPlayState("running"),this):this}},{key:"end",value:function(){n(Scene.prototype.__proto__||Object.getPrototypeOf(Scene.prototype),"end",this).call(this);var e=this._animationItem;return e?(e.off("ended",this._animationend),e.off("iteration",this._animationiteration),this._animationItem=null,this._animationend=null,this._animationiteration=null,this):this}}]),Scene}();u.SCENE_ROLES.transform=!0,u.SCENE_ROLES.filter=!0,f.VERSION="#__VERSION__#",t.default=f},function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var i=function(){function defineProperties(e,t){for(var r=0;r<t.length;r++){var i=t[r];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(e,i.key,i)}}return function(e,t,r){return t&&defineProperties(e.prototype,t),r&&defineProperties(e,r),e}}(),n=_interopRequireDefault(r(3)),o=_interopRequireDefault(r(7)),a=r(5);function _interopRequireDefault(e){return e&&e.__esModule?e:{default:e}}var s=function(e){function Scene(e,t){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,Scene);var r=function(e,t){if(!e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!t||"object"!=typeof t&&"function"!=typeof t?e:t}(this,(Scene.__proto__||Object.getPrototypeOf(Scene)).call(this));return r.items={},r.load(e,t),r}return function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}(Scene,n.default),i(Scene,[{key:"getDuration",value:function(){var e=this.items,t=0;for(var r in e){var i=e[r];t=Math.max(t,i.getTotalDuration()/i.getPlaySpeed())}return t}},{key:"setDuration",value:function(e){var t=this.items,r=this.getDuration();if(!isFinite(r))return this;var i=e/r;for(var n in t){var o=t[n];o.setDelay(o.getDelay()*i),o.setDuration(o.getDuration()*i)}return this}},{key:"getItem",value:function(e){return this.items[e]}},{key:"newItem",value:function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};if((0,a.has)(this.items,e))return this.items[e];var r=new o.default;return this.setItem(e,r),r.setOptions(t),r}},{key:"setItem",value:function(e,t){return t.setId(e),this.items[e]=t,this}},{key:"setIterationTime",value:function(e){(function get(e,t,r){null===e&&(e=Function.prototype);var i=Object.getOwnPropertyDescriptor(e,t);if(void 0===i){var n=Object.getPrototypeOf(e);return null===n?void 0:get(n,t,r)}if("value"in i)return i.value;var o=i.get;return void 0!==o?o.call(r):void 0})(Scene.prototype.__proto__||Object.getPrototypeOf(Scene.prototype),"setIterationTime",this).call(this,e);var t=this.getIterationTime(),r=this.items,i=this.state.easing;for(var n in r){var o=r[n];o.setTime(t*o.state.playSpeed,i,this)}return this}},{key:"load",value:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:e.options;for(var r in e)if("options"!==r){var i=e[r];if(i instanceof o.default)this.setItem(r,i);else this.newItem(r).load(i)}return this.setOptions(t),this}},{key:"forEach",value:function(e){var t=this.items;for(var r in t)e(t[r],r,t)}}]),Scene}();t.default=s},function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var i=function(){function defineProperties(e,t){for(var r=0;r<t.length;r++){var i=t[r];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(e,i.key,i)}}return function(e,t,r){return t&&defineProperties(e.prototype,t),r&&defineProperties(e,r),e}}(),n=_interopRequireDefault(r(4)),o=_interopRequireDefault(r(6)),a=r(5);function _interopRequireDefault(e){return e&&e.__esModule?e:{default:e}}var s=0,u=window.requestAnimationFrame||window.webkitRequestAnimationFrame||window.mozRequestAnimationFrame||function(e){var t=Date.now(),r=Math.max(0,16-(t-s)),i=window.setTimeout(function(){e(t+r)},1e3/60);return s=t+r,i},f=function(e){function Animator(e){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,Animator);var t=function(e,t){if(!e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!t||"object"!=typeof t&&"function"!=typeof t?e:t}(this,(Animator.__proto__||Object.getPrototypeOf(Animator)).call(this));return t._timer=0,t.options={},t.state={easing:0,easingName:"linear",iterationCount:1,delay:0,fillMode:"forwards",direction:"normal",playSpeed:1,currentTime:0,currentIterationTime:-1,currentIterationCount:0,prevTime:0,playState:"paused",duration:0},t.setOptions(e),t}return function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}(Animator,n.default),i(Animator,[{key:"setEasing",value:function(e){return Array.isArray(e)?(this.state.easingName="cubic-bezier("+e.join(",")+")",this.state.easing=o.default.apply(void 0,function(e){if(Array.isArray(e)){for(var t=0,r=Array(e.length);t<e.length;t++)r[t]=e[t];return r}return Array.from(e)}(e))):(this.state.easing=e,this.state.easingName=e.easingName||"linear"),this}},{key:"setOptions",value:function(e){if(!e)return this;for(var t in e)"easing"!==t?"duration"!==t?(t in this.state?this.state:this.options)[t]=e[t]:this.setDuration(e[t]):this.setEasing(e[t]);return this}},{key:"setCurrentIterationCount",value:function(e){var t=parseInt(e,10);this.state.currentIterationCount<t&&this.trigger("iteration",{currentTime:this.state.currentTime,iterationCount:t}),this.state.currentIterationCount=e}},{key:"getTotalDuration",value:function(){return"infinite"===this.state.iterationCount?1/0:this.state.delay+this.getActiveDuration()}},{key:"getActiveDuration",value:function(){return"infinite"===this.state.iterationCount?1/0:this.getDuration()*this.state.iterationCount}},{key:"isEnded",value:function(){return 0===this.getTime()&&"paused"===this.state.playState||!(this.getTime()<this.getTotalDuration())}},{key:"isPaused",value:function(){return"paused"===this.state.playState}},{key:"setNext",value:function(e){return this.on("ended",function(){e.play()}),this}},{key:"play",value:function(){var e=this;return this.isEnded()&&this.setTime(0),this.state.playState="running",u(function(t){e.state.prevTime=t,e.tick(t)}),this.trigger("play"),this}},{key:"pause",value:function(){return this.state.playState="paused",this.trigger("paused"),this}},{key:"end",value:function(){this.pause(),this.trigger("ended")}},{key:"reset",value:function(){return this.setTime(0),this.pause(),this}},{key:"setTime",value:function(e){var t=this.getTotalDuration(),r=e;return r<0?r=0:r>t&&(r=t),this.state.currentTime=r,this.calculateIterationTime(),this.trigger("timeupdate",{currentTime:r,time:this.getIterationTime(),iterationCount:this.getIterationCount()}),this}},{key:"getTime",value:function(){return this.state.currentTime}},{key:"getActiveTime",value:function(){return parseInt(1e4*Math.max(this.state.currentTime-this.state.delay,0),10)/1e4}},{key:"calculateIterationTime",value:function(){var e=this.state,t=e.iterationCount,r=e.fillMode,i=e.direction,n=this.getDuration(),o=this.getActiveTime(),a=this.state.currentTime-this.state.delay<0,s=0===n?0:o/n,u=s%2>=1,f=n?o%n:0,l=!1;if(a)return this.setIterationTime(0),this;switch(this.setCurrentIterationCount(s),i){case"reverse":f=n-f;break;case"alternate":u&&(f=n-f),l=!0;break;case"alternate-reverse":u||(f=n-f),l=!0}switch(r){case"both":case"forwards":if(l||s!==t||t%1!=0)break;f=n-f;break;default:if(s!==t||t%1!=0)break;f=0}return this.setIterationTime(f),this}},{key:"caculateEasing",value:function(e){if(!this.state.easing)return e;var t=this.getDuration();return(0,this.state.easing)(0===t?0:e/t)*e}},{key:"getIterationTime",value:function(){return this.state.currentIterationTime}},{key:"setIterationTime",value:function(e){var t=e;return this.state.currentIterationTime=t,this}},{key:"tick",value:function(e){var t=this,r=this.state.playSpeed,i=this.state.prevTime,n=this.getTime()+Math.min(1e3,e*r-i)/1e3;this.state.prevTime=e*r,this.setTime(n),this.isEnded()&&this.end(),"paused"!==this.state.playState&&u(function(e){t.tick(e)})}}]),Animator}(),l=f.prototype;(0,a.defineGetterSetter)(l,"delay","state"),(0,a.defineGetterSetter)(l,"fillMode","state"),(0,a.defineGetterSetter)(l,"iterationCount","state"),(0,a.defineGetterSetter)(l,"direction","state"),(0,a.defineGetterSetter)(l,"playState","state"),(0,a.defineGetterSetter)(l,"playSpeed","state"),(0,a.defineGetterSetter)(l,"duration","state"),(0,a.defineGetter)(l,"easingName","state"),(0,a.defineGetter)(l,"easing","state"),t.default=f},function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var i=function(){function defineProperties(e,t){for(var r=0;r<t.length;r++){var i=t[r];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(e,i.key,i)}}return function(e,t,r){return t&&defineProperties(e.prototype,t),r&&defineProperties(e,r),e}}(),n=r(5);var o=function(){function EventTrigger(){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,EventTrigger),this._events={}}return i(EventTrigger,[{key:"on",value:function(e,t){var r=this._events,i=void 0,o=void 0;if((0,n.isObject)(e)){for(i in e)this.on(i,e[i]);return this}if((0,n.has)(r,e)||(r[e]=[]),(0,n.isObject)(t)){for(o in t)this.on(e,t[o]);return this}return t?(r[e].push(t),this):this}},{key:"off",value:function(e,t){if(e)if(t){var r=this._events[e];if(!r)return this;var i=r.indexOf(t);-1!==i&&r.splice(i,1)}else this._events[e]=[];else this._events={};return this}},{key:"trigger",value:function(e){for(var t=this,r=arguments.length,i=Array(r>1?r-1:0),o=1;o<r;o++)i[o-1]=arguments[o];var a=this._events;if(!(0,n.has)(a,e))return this;var s=a[e];if(i.length){var u=i[0];u.type=e,u.currentTarget=this,!u.target&&(u.target=this)}return s.forEach(function(e){e.apply(t,i)}),this}}]),EventTrigger}();o.defaultEvents={},t.default=o},function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var i="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},n=(t.isPercent=function(e){return~e.search(/([0-9]|\.|-|e-|e\+)+%/g)},t.isUndefined=function(e){return void 0===e},t.isObject=function(e){return"object"===(void 0===e?"undefined":i(e))},t.isArray=function(e){return Array.isArray(e)},t.isString=function(e){return"string"==typeof e},t.has=function(e,t){return Object.prototype.hasOwnProperty.call(e,t)},t.splitUnit=function(e){var t=""+e;try{var r=t.match(/([0-9]|\.|-|e-|e\+)+/g,"")[0];return{unit:t.replace(r,"")||"",value:r=parseFloat(r)}}catch(e){return{unit:t}}},t.camelize=function(e){return e.replace(/[\s-_]([a-z])/g,function(e,t){return t.toUpperCase()})}),o=t.defineGetter=function(e,t,r){e[n("get "+t)]=function(){return(r?this[r]:this)[t]}},a=t.defineSetter=function(e,t,r){e[n("set "+t)]=function(e){return r?this[r][t]=e:this[t]=e,this}};t.defineGetterSetter=function(e,t,r){o(e,t,r),a(e,t,r)},t.fill=function(e,t){for(var r=e.length,i=0;i<r;++i)e[i]=t;return e}},function(e,t,r){"use strict";function cubic(e,t,r){var i=1-r;return r*r*r+3*r*r*i*t+3*r*i*i*e}Object.defineProperty(t,"__esModule",{value:!0}),t.default=function(e,t,r,i){var n=function(n){var o=function(e,t,r){var i=r,n=r,o=1;for(;Math.abs(o)>.001;){if(n=cubic(e,t,i),o=n-r,Math.abs(o)<.001)return i;i-=o/2}return i}(e,r,Math.max(Math.min(1,n),0));return cubic(t,i,o)};return n.easingName="cubic-bezier("+e+", "+t+", "+r+", "+i+")",n}},function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var i=function(){function defineProperties(e,t){for(var r=0;r<t.length;r++){var i=t[r];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(e,i.key,i)}}return function(e,t,r){return t&&defineProperties(e.prototype,t),r&&defineProperties(e,r),e}}(),n=function get(e,t,r){null===e&&(e=Function.prototype);var i=Object.getOwnPropertyDescriptor(e,t);if(void 0===i){var n=Object.getPrototypeOf(e);return null===n?void 0:get(n,t,r)}if("value"in i)return i.value;var o=i.get;return void 0!==o?o.call(r):void 0},o=_interopRequireDefault(r(3)),a=_interopRequireDefault(r(8)),s=r(5),u=_interopRequireDefault(r(13)),f=r(15);function _interopRequireDefault(e){return e&&e.__esModule?e:{default:e}}var l=function(e){function SceneItem(e,t){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,SceneItem);var r=function(e,t){if(!e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!t||"object"!=typeof t&&"function"!=typeof t?e:t}(this,(SceneItem.__proto__||Object.getPrototypeOf(SceneItem)).call(this));return r.timeline=new u.default,r.load(e,t),r}return function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}(SceneItem,o.default),i(SceneItem,[{key:"getDuration",value:function(){return Math.max(this.state.duration,this.timeline.getLastTime())}},{key:"setDuration",value:function(e){var t=e/this.getDuration(),r=this.timeline,i=r.times,o=r.items,a={};r.times=i.map(function(e){var r=e*t;return a[r]=o[e],r}),r.items=a,n(SceneItem.prototype.__proto__||Object.getPrototypeOf(SceneItem.prototype),"setDuration",this).call(this,e)}},{key:"setId",value:function(e){this.state.id=e}},{key:"getId",value:function(){return this.state.id}},{key:"set",value:function(e,t,r,i){var n=this;if((0,s.isArray)(e))return e.forEach(function(e){n.set(e,t,r,i)}),this;if((0,s.isObject)(e))return this.load(e),this;var o=this.getFrame(e)||this.newFrame(e);return o.set(t,r,i),this.updateFrame(o),this}},{key:"get",value:function(e,t,r){var i=this.getFrame(e);return i&&i.get(t,r)}},{key:"remove",value:function(e,t,r){var i=this.getFrame(e);return i&&i.remove(t,r),this}},{key:"animate",value:function(e,t,r){var i=this.getIterationTime(),n=this.getEasing()||t,o=this.getNowFrame(i,n);if(!o)return o;var a=this.getTime();return this.trigger("animate",{frame:o,currentTime:a,time:i}),r&&r.trigger("animate",{frame:o,currentTime:a,target:this,time:i}),o}},{key:"setTime",value:function(e,t,r){return n(SceneItem.prototype.__proto__||Object.getPrototypeOf(SceneItem.prototype),"setTime",this).call(this,e),this.animate(e,t,r),this}},{key:"update",value:function(){return this.timeline.update(),this}},{key:"updateFrame",value:function(e){return this.timeline.updateFrame(e),this}},{key:"newFrame",value:function(e){var t=this.getFrame(e);return t||(t=new a.default,(0,s.isUndefined)(e)||this.setFrame(e,t),t)}},{key:"setFrame",value:function(e,t){return this.timeline.add(e,t),this.timeline.update(),this}},{key:"_getTime",value:function(e){var t=(arguments.length>1&&void 0!==arguments[1]?arguments[1]:{}).duration||this.getDuration()||100;if((0,s.isString)(e)){if((0,s.isPercent)(e))return!this.getDuration()&&(this.state.duration=t),parseFloat(e)/100*t;if("from"===e)return 0;if("to"===e)return t}return parseFloat(e)}},{key:"getFrame",value:function(e){return this.timeline.get(this._getTime(e))}},{key:"hasFrame",value:function(e){return this.timeline.has(e)}},{key:"removeFrame",value:function(e){var t=this.timeline;return t.remove(e),t.update(),this}},{key:"copyFrame",value:function(e,t){var r=void 0;if((0,s.isObject)(e)){for(r in e)this.copyFrame(r,e[r]);return this}var i=this.getFrame(e);if(!i)return this;var n=i.clone();return this.setFrame(t,n),this}},{key:"mergeFrame",value:function(e,t){var r=void 0;if((0,s.isObject)(e)){for(r in e)this.mergeFrame(r,e[r]);return this}var i=this.getFrame(e);return i?(this.newFrame(t).merge(i),this):this}},{key:"getNowValue",value:function(e,t,r){var i=arguments.length>3&&void 0!==arguments[3]?arguments[3]:this.timeline.size(),n=arguments.length>4&&void 0!==arguments[4]?arguments[4]:0,o=arguments.length>5&&void 0!==arguments[5]?arguments[5]:this.state.easing,a=this.timeline,u=a.times,l=u.length,c=u[i],h=u[n],p=a.get(c),v=a.get(h);if(r>=c)for(var d=i;d>=0&&(c=u[d],!(p=a.get(c)).has(e,t));--d);for(var m=n;m<l&&(h=u[m],!(v=a.get(h)).has(e,t));++m);var y=p&&p.get(e,t),_=v&&v.get(e,t);if((0,s.isUndefined)(y))return _;if((0,s.isUndefined)(_)||y===_)return y;c<0&&(c=0);var g=u[i],b=u[n],O=this.state.easing||o;return(0,f.dotValue)({time:r,prevTime:c,nextTime:h,startTime:g,endTime:b,prevValue:y,nextValue:_,easing:O})}},{key:"getNearIndex",value:function(e){var t=this.timeline,r=t.times,i=t.getLastTime(),n=t.size();if(0!==n){var o=parseInt(i>0?e*n/i:0,10),a=n-1,s=0;if(o<0?o=0:o>a&&(o=a),e<r[a])for(;s<a;){if((s===o||a===o)&&s+1===a){e<r[s]&&(a=s);break}if(r[o]>e)a=o;else{if(!(r[o]<e)){s=a=o;break}s=o}o=parseInt((s+a)/2,10)}else s=o=a;return{left:s,right:a}}}},{key:"getNowFrame",value:function(e,t){var r=this.getNearIndex(e);if(!r)return r;var i=r.left,n=r.right,o=this.newFrame(),a=this.timeline.names;for(var u in a){var f=a[u];for(var l in f){var c=this.getNowValue(u,l,e,i,n,t);(0,s.isUndefined)(c)||o.set(u,l,c)}}return o}},{key:"load",value:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:e.options;if(this.setOptions(t),(0,s.isArray)(e)){for(var r=e.length,i=0;i<r;++i){var n=1===r?0:this._getTime(i/(r-1)*100+"%",t);this.set(n,e[i])}return this}for(var o in e)if("options"!==o){var a=e[o],u=this._getTime(o);"number"!=typeof a?this.set(u,e[o]):this.mergeFrame(a,u)}return this}},{key:"clone",value:function(){var e=this,t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},r=new this.constructor,i=this.timeline.times;return r.setOptions(this.state),r.setOptions(t),i.forEach(function(t){return r.setFrame(t,e.getFrame(t).clone())}),r}}]),SceneItem}();t.default=l},function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var i,n=function(){function defineProperties(e,t){for(var r=0;r<t.length;r++){var i=t[r];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(e,i.key,i)}}return function(e,t,r){return t&&defineProperties(e.prototype,t),r&&defineProperties(e,r),e}}(),o=r(9),a=r(5),s=r(10),u=r(11),f=(i=u)&&i.__esModule?i:{default:i};function isPropertyObject(e){return e instanceof f.default}function clone(e){return _merge({},e,arguments.length>1&&void 0!==arguments[1]&&arguments[1])}function _merge(e,t){var r=arguments.length>2&&void 0!==arguments[2]&&arguments[2];for(var i in t){var n=t[i];(0,a.isObject)(n)?n instanceof f.default?e[i]=r?n.toValue():n.clone():(0,a.isArray)(n)?e[i]=n.slice():!(0,a.isObject)(e[i])||e[i]instanceof f.default?e[i]=clone(n,r):_merge(e[i],n,r):e[i]=t[i]}return e}var l=function(){function Frame(e){for(var t in function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,Frame),this.properties={},o.SCENE_ROLES)this.properties[t]={};this.load(e)}return n(Frame,[{key:"load",value:function(e){if(e&&!(0,a.isObject)(e))return this;for(var t in e){var r=e[t];(0,a.has)(o.SCENE_ROLES,t)?this.set(t,r):!(0,a.isObject)(r)||(0,a.isArray)(r)||isPropertyObject(r)?this._set(o.PROPERTY,t,r):this.set(t,r)}return this}},{key:"get",value:function(e,t){return t?this.properties[e]&&this.properties[e][t]:e in o.SCENE_ROLES?this.properties[e]:this.properties[o.PROPERTY][e]}},{key:"remove",value:function(e,t){return t?delete this.properties[e][t]:e in o.SCENE_ROLES?delete this.properties[e]:delete this.properties[o.PROPERTY][e],this}},{key:"_set",value:function(e,t,r){var i=e.trim();i in this.properties||(this.properties[i]={}),this.properties[i][t]=(0,a.isString)(r)?(0,s.toPropertyObject)(r):r}},{key:"set",value:function(e,t,r){var i=this;if((0,a.isObject)(e))return this.load(e),this;if((0,a.isUndefined)(t)){for(var n=e.split(";"),o=n.length,u=0;u<o;++u){var f=/([^:]*):([\S\s]*)/g.exec(n[u]);!f||f.length<3||!f[1]||this.set(f[1].trim(),f[2])}return this}if((0,a.isObject)(t)){for(var l in t)this._set(e,l,t[l]);return this}if((0,a.isUndefined)(r)){if((0,a.isString)(t)){var c=(0,s.splitSpace)(t).map(function(e){return(0,s.toPropertyObject)(e)});if(c.every(function(e){return e.model&&"color"!==e.type}))return c.forEach(function(t){var r=t.model;t.model="",t.prefix="",t.suffix="",i._set(e,r,1===t.size()?t.get(0):t)}),this}return this._set("property",e,t),this}return this._set(e,t,r),this}},{key:"has",value:function(e,t){return this.properties[e]&&(0,a.has)(this.properties[e],t)}},{key:"clone",value:function(){var e=new this.constructor;return e.merge(this),e}},{key:"merge",value:function(e){var t=this.properties,r=e.properties;return r?(_merge(t,r),this):this}},{key:"toObject",value:function(){return clone(this.properties,!0)}}]),Frame}();t.default=l},function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.EASE_IN_OUT=t.EASE_OUT=t.EASE_IN=t.EASE=t.LINEAR=t.PLAY_DIRECTION=t.FILL_MODE=t.ANIMATION_PLAY_STATE=t.SCENE_ROLES=t.PROPERTY=t.PREFIX=void 0;var i,n=r(6),o=(i=n)&&i.__esModule?i:{default:i};t.PREFIX="__SCENEJS_";var a=t.PROPERTY="property";t.SCENE_ROLES=function(e,t,r){return t in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}({},a,!0),t.ANIMATION_PLAY_STATE=["idle","pending","paused","running","finished"],t.FILL_MODE=["none","forwards","backwards","both","auto"],t.PLAY_DIRECTION=["normal","reverse","alternate","alternate-reverse"],t.LINEAR=(0,o.default)(0,0,1,1),t.EASE=(0,o.default)(.25,.1,.25,1),t.EASE_IN=(0,o.default)(.42,0,1,1),t.EASE_OUT=(0,o.default)(0,0,.58,1),t.EASE_IN_OUT=(0,o.default)(.42,0,.58,1)},function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.stringToColorObject=t.toPropertyObject=t.arrayToPropertyObject=t.toBracketObject=t.toColorObject=t.arrayToColorObject=t.splitComma=t.splitSpace=void 0;var i,n=r(11),o=(i=n)&&i.__esModule?i:{default:i},a=r(12),s=r(5);var u=void 0,f=void 0,l=t.splitSpace=function(e){for(var t=e.split(/("[^"]*"|'[^']*'|[^\s()]*(?:\((?:[^()]*|\([^()]*\))*\))[^\s()]*)|\s+/g),r=t.length,i=[],n=void 0,o=void 0,a=0,u=0;u<r;++u)n=t[u],(0,s.isUndefined)(n)?i[a]&&++a:n&&(o=i[a],i[a]=o?o+n:n);return i},c=t.splitComma=function(e){for(var t=e.split(/("[^"]*"|'[^']*'|[^,\s()]*(?:\((?:[^()]*|\([^()]*\))*\))[^,\s()]*)|\s*,\s*/g),r=t.length,i=[],n=void 0,o=void 0,a=0,u=0;u<r;++u)n=t[u],(0,s.isUndefined)(n)?i[a]&&++a:n&&(o=i[a],i[a]=o?o+n:n);return i},h=t.arrayToColorObject=function(e){return e instanceof o.default?(e.type="color",e.model="rgba",e.prefix="rgba(",e):(3===e.length&&(e[3]=1),new o.default(e,{model:"rgba",separator:",",type:"color",prefix:"rgba(",suffix:")"}))},p=t.toColorObject=function(e){var t=void 0;if(e instanceof o.default)t=e;else{if(!(0,s.isObject)(e))return(0,s.isString)(e)?f(e):e;t=h(e)}var r=t.value,i=r.length;4===i?r[3]=parseFloat(r[3]):3===i&&(r[3]=1),t.type="color";var n=t.model.toLowerCase(),u=void 0;switch("rgb"===n&&h(t),n){case"rgb":case"rgba":for(u=0;u<3;++u)r[u]=parseInt(r[u],10);break;case"hsl":case"hsla":for(u=1;u<3;++u)-1!==r[u].indexOf("%")&&(r[u]=parseFloat(r[u])/100);return r=(0,a.hslToRGB)(r),h(r)}return t},v=t.toBracketObject=function(e){var t=/([^(]*)\(([\s\S]*)\)([\s\S]*)/g.exec(e);if(!t||t.length<4)return e;var r=t[1]||"",i=r+"(",n=t[2],a=")"+t[3],s=c(n),f=void 0,l=",";return 1===s.length&&((f=u(n)).prefix||f.suffix||(l=f.separator,f=f.value)),f||(f=s.map(function(e){return u(e)})),new o.default(f,{separator:l,model:r,prefix:i,suffix:a})},d=t.arrayToPropertyObject=function(e){return new o.default(e,{type:"array"})};t.stringToColorObject=f=function(e){var t=0,r=0;if("#"===e.charAt(0))return t=4===e.length?(0,a.hexToRGB)((0,a.hex3to6)(e)):(e.length,(0,a.hexToRGB)(e)),h(t);if(-1===e.indexOf("("))throw new Error("Invalid Format : Not a Color - "+e);return r=v(e),p(r)},t.toPropertyObject=u=function(e){if(!(0,s.isString)(e))return Array.isArray(e)?d(e):e;var t=c(e),r=void 0;if(t.length>1)return(r=new o.default(t.map(function(e){return u(e)}),",")).type="array",r;if((t=l(e)).length>1)return(r=new o.default(t.map(function(e){return u(e)})," ")).type="array",r;if((r=e.charAt(0))&&('"'===r||"'"===r))return e;if(-1!==e.indexOf("(")){if(r=v(e),!(0,s.isObject)(r))return r;var i=r.model.toLowerCase();if(-1!==a.COLOR_MODELS.indexOf(i))return p(r);for(var n=r.length,f=0;f<n;++f)r.set(f,u(r.get(f)));return r}return 0===e.indexOf("#")?p(e):e},t.toPropertyObject=u,t.stringToColorObject=f},function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var i=function(){function defineProperties(e,t){for(var r=0;r<t.length;r++){var i=t[r];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(e,i.key,i)}}return function(e,t,r){return t&&defineProperties(e.prototype,t),r&&defineProperties(e,r),e}}(),n=r(5);var o=function(){function PropertyObject(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:",";!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,PropertyObject),this.prefix="",this.suffix="",this.model="",this.type="",this.separator=",",this.init(e,t)}return i(PropertyObject,[{key:"init",value:function(e,t){var r=void 0;if((0,n.isObject)(t))for(r in t)this[r]=t[r];else this.separator=t;(0,n.isString)(e)?this.value=e.split(this.separator):(0,n.isObject)(e)?this.value=e:this.value=[e]}},{key:"size",value:function(){return this.value.length}},{key:"get",value:function(e){return this.value[e]}},{key:"set",value:function(e,t){return this.value[e]=t,this}},{key:"clone",value:function(){return new PropertyObject(this.value.map(function(e){return e instanceof PropertyObject?e.clone():e}),{separator:this.separator,prefix:this.prefix,suffix:this.suffix,model:this.model,type:this.type})}},{key:"toValue",value:function(){return this.prefix+this.join()+this.suffix}},{key:"join",value:function(){var e=this.separator;return this.value.map(function(e){return e instanceof PropertyObject?e.toValue():e}).join(e)}},{key:"forEach",value:function(e){return this.value.forEach(e),this}}]),PropertyObject}();t.default=o},function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0});t.COLOR_MODELS=["rgb","rgba","hsl","hsla"];var i=t.cutHex=function(e){return"#"===e.charAt(0)?e.substring(1):e};t.hexToRGB=function(e){var t=i(e),r=parseInt(t.substring(0,2),16),n=parseInt(t.substring(2,4),16),o=parseInt(t.substring(4,6),16),a=parseInt(t.substring(6,8),16)/255;return isNaN(a)&&(a=1),[r,n,o,a]},t.hex3to6=function(e){var t=e.charAt(1),r=e.charAt(2),i=e.charAt(3);return["#",t,t,r,r,i,i].join("")},t.hslToRGB=function(e){var t=e[0],r=e[1],i=e[2];t<0&&(t+=360*parseInt((Math.abs(t)+360)/360,10)),t%=360;var n=(1-Math.abs(2*i-1))*r,o=n*(1-Math.abs(t/60%2-1)),a=i-n/2,s=void 0;t<60?s=[n,o,0]:t<120?s=[o,n,0]:t<180?s=[0,n,o]:t<240?s=[0,o,n]:t<300?s=[o,0,n]:t<360&&(s=[n,0,o]);var u=[Math.round(255*(s[0]+a)),Math.round(255*(s[1]+a)),Math.round(255*(s[2]+a))];return e.length>3&&(u[3]=e[3]),u}},function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var i,n=function(){function defineProperties(e,t){for(var r=0;r<t.length;r++){var i=t[r];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(e,i.key,i)}}return function(e,t,r){return t&&defineProperties(e.prototype,t),r&&defineProperties(e,r),e}}(),o=r(14),a=(i=o)&&i.__esModule?i:{default:i};var s=function(e){function FrameTimeline(){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,FrameTimeline);var e=function(e,t){if(!e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!t||"object"!=typeof t&&"function"!=typeof t?e:t}(this,(FrameTimeline.__proto__||Object.getPrototypeOf(FrameTimeline)).call(this));return e.names={},e}return function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}(FrameTimeline,a.default),n(FrameTimeline,[{key:"hasName",value:function(e,t){var r=this.names;return e in r&&r[e]&&t in r[e]}},{key:"update",value:function(){var e=this.items;for(var t in e)this.updateFrame(e[t]);return this}},{key:"updateFrame",value:function(e){if(!e)return this;var t=e.properties,r=this.names;for(var i in t){r[i]=r[i]||{};var n=t[i];for(var o in n)r[i][o]=!0}return this}}]),FrameTimeline}();t.default=s},function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var i=function(){function defineProperties(e,t){for(var r=0;r<t.length;r++){var i=t[r];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(e,i.key,i)}}return function(e,t,r){return t&&defineProperties(e.prototype,t),r&&defineProperties(e,r),e}}(),n=r(5);var o=function(){function Timeline(){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,Timeline),this.times=[],this.items={}}return i(Timeline,[{key:"getLastTime",value:function(){var e=this.times;return 0===e.length?0:e[e.length-1]}},{key:"size",value:function(){return this.times.length}},{key:"add",value:function(e,t){return this.items[e]=t,this.addTime(e),this}},{key:"addTime",value:function(e){var t=this.times,r=t.length,i=r,n=void 0;for(n=0;n<r;++n){if(e===t[n])return this;if(e<t[n]){i=n;break}}return this.times.splice(i,0,e),this}},{key:"has",value:function(e){return(0,n.has)(this.items,e)}},{key:"get",value:function(e){return this.items[e]}},{key:"remove",value:function(e){return delete this.items[e],this.removeTime(e),this}},{key:"removeTime",value:function(e){var t=this.times.indexOf(e);return-1===t?this:(this.times.splice(t,1),this)}}]),Timeline}();t.default=o},function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.dot=t.dotValue=t.dotObject=t.dotColor=t.dotArray=void 0;var i,n=r(5),o=r(11),a=(i=o)&&i.__esModule?i:{default:i},s=r(10);var u=void 0,f=t.dotArray=function(e,t,r,i){if(0===i)return t;if(!(0,n.isArray)(t))return e;var o=t.length;return e.map(function(e,n){return n>=o?e:u(e,t[n],r,i)})},l=t.dotColor=function(e,t,r,i){var n=e,o=t;n instanceof a.default||(n=(0,s.toColorObject)(n)),o instanceof a.default||(o=(0,s.toColorObject)(o));var l=n.value,c=o.value,h=n.model;if(h!==o.model)return u(n.toValue(),o.toValue(),r,i);3===l.length&&(l[3]=1),3===c.length&&(c[3]=1);for(var p=f(l,c,r,i),v=h,d=0;d<3;++d)p[d]=parseInt(p[d],10);return new a.default(p,{type:"color",model:v,prefix:v+"(",suffix:")"})},c=t.dotObject=function(e,t,r,i){var o=e.type;if("color"===o)return l(e,t,r,i);var s=e.value,u=t.value;if(!(0,n.isObject)(t))return e;var c=f(s,u,r,i);return new a.default(c,{type:o,separator:e.separator||t.separator,prefix:e.prefix||t.prefix,suffix:e.suffix||t.suffix,model:e.model||t.model})};t.dot=u=function(e,t,r,i){if(e instanceof a.default)return c(e,t,r,i);if((0,n.isArray)(e))return f(e,t,r,i);if(r+i===0)return e;var o=(0,n.splitUnit)(e),s=(0,n.splitUnit)(t),u=r/(r+i),l=1-u,h=void 0;if(isNaN(o.value)||isNaN(s.value))return u>=1?t:e;h=o.value*l+s.value*u;var p=o.unit||s.unit||!1;return!1===p?h:h+p.trim()};t.dotValue=function(e){var t=e.time,r=e.prevTime,i=e.nextTime,n=e.startTime,o=void 0===n?r:n,a=e.endTime,s=void 0===a?i:a,f=e.prevValue,l=e.nextValue,c=e.easing;if(!c||o===s)return u(f,l,t-r,i-t);var h=u(f,l,o-r,i-o),p=u(f,l,s-r,i-s),v=c((t-o)/(s-o));return u(h,p,v,1-v)};t.dot=u},function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var i=function(){function defineProperties(e,t){for(var r=0;r<t.length;r++){var i=t[r];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(e,i.key,i)}}return function(e,t,r){return t&&defineProperties(e.prototype,t),r&&defineProperties(e,r),e}}(),n=function get(e,t,r){null===e&&(e=Function.prototype);var i=Object.getOwnPropertyDescriptor(e,t);if(void 0===i){var n=Object.getPrototypeOf(e);return null===n?void 0:get(n,t,r)}if("value"in i)return i.value;var o=i.get;return void 0!==o?o.call(r):void 0},o=_interopRequireDefault(r(7)),a=r(9),s=r(17),u=_interopRequireDefault(r(18)),f=r(19);function _interopRequireDefault(e){return e&&e.__esModule?e:{default:e}}var l={fillMode:"fill-mode",name:"name",delay:"delay",iterationCount:"iteration-count",easing:"timing-function",direction:"direction",duration:"duration",playState:"play-state"};function makeId(){for(;;){var e=""+parseInt(1e5*Math.random(),10);if(!document.querySelector('[data-scene-id="'+e+'"]'))return e}}function makeAnimationProperties(e){var t=[];for(var r in e)t.push(f.ANIMATION+"-"+(l[r]||r)+" : "+e[r]+";");return t.join("")}var c=function(e){function SceneItem(){return function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,SceneItem),function(e,t){if(!e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!t||"object"!=typeof t&&"function"!=typeof t?e:t}(this,(SceneItem.__proto__||Object.getPrototypeOf(SceneItem)).apply(this,arguments))}return function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}(SceneItem,o.default),i(SceneItem,[{key:"newFrame",value:function(e){var t=this.getFrame(e);return t||(t=new u.default,void 0!==e&&this.setFrame(e,t),t)}},{key:"setId",value:function(e){var t=this._elements;n(SceneItem.prototype.__proto__||Object.getPrototypeOf(SceneItem.prototype),"setId",this).call(this,e);var r=(0,s.toId)(this.state.id);if(this.options.selector||(this.options.selector='[data-scene-id="'+r+'"]'),!t)return this;var i=t.length;if(!i)return this;for(var o=0;o<i;++o)t[o].setAttribute("data-scene-id",r);return this}},{key:"animate",value:function(e,t,r){var i=n(SceneItem.prototype.__proto__||Object.getPrototypeOf(SceneItem.prototype),"animate",this).call(this,e,t,r),o=this._elements;if(!o||!o.length)return i;var a=i.toCSS();if(this.state.cssText===a)return i;this.state.cssText=a;for(var s=o.length,u=0;u<s;++u)o[u].style.cssText+=a;return i}},{key:"setSelector",value:function(e){return this.options.selector=!0===e?this.state.id:e||'[data-scene-id="'+this.state.id+'"]',this.setElement(document.querySelectorAll(e)),this}},{key:"setElement",value:function(e){if(!e)return this;if("string"==typeof e)return this.setSelector(e);var t=this.state.id;return this._elements=e instanceof Element?[e]:e,this.setId(t&&"null"!==t?t:makeId()),this}},{key:"setCSS",value:function(e,t){return this.set(e,this.fromCSS(t)),this}},{key:"fromCSS",value:function(e){if(!e||!e.length)return{};var t=this._elements;if(!t||!t.length)return{};for(var r={},i=window.getComputedStyle(t[0]),n=e.length,o=0;o<n;++o)r[e[o]]=i[e[o]];return r}},{key:"setOptions",value:function(e){n(SceneItem.prototype.__proto__||Object.getPrototypeOf(SceneItem.prototype),"setOptions",this).call(this,e);var t=e&&e.selector,r=this.options.elements||this.options.element;return t||r?(r&&this.setElement(r),!0===t?this.setSelector(this.state.id):this.setSelector(t),this):this}},{key:"_toKeyframes",value:function(){var e=this,t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:this.getDuration(),r=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{},i=this.state.id||this.setId(makeId()).state.id;if(!i)return"";var n=this.getDuration(),o=this.timeline.times.slice(),u=this.state.playSpeed,l=void 0!==r.iterationCount,c=l&&this.state.delay||0,h=l&&this.state.direction,p=[],v=this.state.iterationCount;!this.getFrame(0)&&o.unshift(0),!this.getFrame(n)&&o.push(n);var d=o.length,m=o.map(function(t){return e.getNowFrame(t,!1).toCSS()});v=l&&"infinite"!==v?v:1;var y=!1,_=!1;"alternate-reverse"!==h&&"alternate"!==h||(y=!0),c&&(p.push("0%{"+m[0]+"}"),"revsere"!==h&&"alternate-reverse"!==h||p.push(c/u/t*100-1e-5+"%{"+m[0]+"}"));for(var g=0;g<v;++g){var b=g%2==0,O=c+g*n,S=!1;switch(h){case"reverse":S=!0;break;case"alternate":b||(S=!0);break;case"alternate-reverse":b&&(S=!0)}for(var T=0;T<d;++T){var k=S?d-1-T:T,E=m[k],I=o[k],P=(O+(S?n-I:I))/u/t*100;if(P>100)break;100===P&&(_=!0),0!==g&&0===T?y||p.push(P+1e-4+"%{"+E+"}"):p.push(P+"%{"+E+"}")}if(g+1>=v&&!_){var j=v%1,w=j?this.getNowFrame(n*(S?1-j:j)).toCSS():m[S?0:d-1];j&&p.push(v*n/u/t*100+"%{"+w+"}"),p.push("100%{"+w+"}")}}return"@"+f.KEYFRAMES+" "+a.PREFIX+"KEYFRAMES_"+(0,s.toId)(i)+"{\n\t\t\t"+p.join("\n")+"\n\t\t}"}},{key:"toCSS",value:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:this.getDuration(),t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{},r=this.state.id||this.setId(makeId()).state.id;if(!r)return"";var i=0===e,n=this.options.selector,o=t.playSpeed||1,u=((void 0===t.delay?this.state.delay:t.delay)||0)/o,l=!i&&t.easing&&t.easingName||this.state.easingName,c=!i&&t.iterationCount||this.state.iterationCount,h=makeAnimationProperties({fillMode:"forwards"!==t.fillMode&&t.fillMode||this.state.fillMode,direction:"none"!==t.direction&&t.direction||this.state.direction,delay:u+"s",name:a.PREFIX+"KEYFRAMES_"+(0,s.toId)(r),duration:e/o+"s",easing:l,iterationCount:c});return n+"."+f.START_ANIMATION+" {\n\t\t\t"+h+"\n\t\t}\n\t\t"+this._toKeyframes(e,t)}},{key:"exportCSS",value:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:this.getDuration(),t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{},r=(0,s.toId)(this.state.id||this.setId(makeId()).state.id||"");if(r){var i=document.querySelector("#"+a.PREFIX+r),n=this.toCSS(e,t);i?i.innerText=n:document.body.insertAdjacentHTML("beforeend",'<style id="'+a.PREFIX+"STYLE_"+r+'">'+n+"</style>")}}},{key:"playCSS",value:function(){var e=this,t=!(arguments.length>0&&void 0!==arguments[0])||arguments[0],r=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};if(!f.ANIMATION||"running"===this.getPlayState())return this;var i=this._elements;if(!i||!i.length)return this;this.isEnded()&&this.setTime(0),this.setPlayState("running"),t&&this.exportCSS();for(var n=i.length,o=makeAnimationProperties(r),a=0;a<n;++a){var u=i[a];u.style.cssText+=o,(0,s.hasClass)(u,f.START_ANIMATION)?((0,s.removeClass)(u,f.START_ANIMATION),function(e){requestAnimationFrame(function(){requestAnimationFrame(function(){(0,s.addClass)(e,f.START_ANIMATION)})})}(u)):(0,s.addClass)(u,f.START_ANIMATION)}this.setPlayState("running"),this.trigger("play");var l=this.getDuration();return this._animationend=function(t){e.end()},this._animationiteration=function(t){var r=t.elapsedTime,i=r/l;e.state.currentTime=r,e.setCurrentIterationCount(i)},i[0].addEventListener("animationend",this._animationend),i[0].addEventListener("animationiteration",this._animationiteration),this}},{key:"end",value:function(){n(SceneItem.prototype.__proto__||Object.getPrototypeOf(SceneItem.prototype),"end",this).call(this);var e=this._elements;return e&&e.length&&this._animationend?(e[0].removeEventListener("animationend",this._animationend),e[0].removeEventListener("animationiteration",this._animationiteration),this._animationend=null,this._animationiteration=null,this):this}}]),SceneItem}();t.default=c},function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0});t.toId=function(e){return e.match(/[0-9a-zA-Z]+/g).join("")},t.hasClass=function(e,t){return e.classList?e.classList.contains(t):!!e.className.match(new RegExp("(\\s|^)"+t+"(\\s|$)"))},t.addClass=function(e,t){e.classList?e.classList.add(t):e.className+=" "+t},t.removeClass=function(e,t){if(e.classList)e.classList.remove(t);else{var r=new RegExp("(\\s|^)"+t+"(\\s|$)");e.className=e.className.replace(r," ")}}},function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var i,n=function(){function defineProperties(e,t){for(var r=0;r<t.length;r++){var i=t[r];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(e,i.key,i)}}return function(e,t,r){return t&&defineProperties(e.prototype,t),r&&defineProperties(e,r),e}}(),o=r(8),a=(i=o)&&i.__esModule?i:{default:i},s=r(19);function toInnerProperties(e){if(!e)return"";var t=[];for(var r in e)t.push(r+"("+e[r]+")");return t.join(" ")}var u=function(e){function Frame(){return function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,Frame),function(e,t){if(!e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!t||"object"!=typeof t&&"function"!=typeof t?e:t}(this,(Frame.__proto__||Object.getPrototypeOf(Frame)).apply(this,arguments))}return function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}(Frame,a.default),n(Frame,[{key:"toCSSObject",value:function(){var e=this.toObject(),t={},r=e.property;for(var i in r)t[i]=r[i];var n=toInnerProperties(e.transform),o=toInnerProperties(e.filter);return s.TRANSFORM&&n&&(t[s.TRANSFORM]=n),s.FILTER&&o&&(t[s.FILTER]=o),t}},{key:"toCSS",value:function(){var e=this.toCSSObject(),t=[];for(var r in e)t.push(r+":"+e[r]+";");return t.join("")}}]),Frame}();t.default=u},function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var i=function(e,t){var r=(document.body||document.documentElement).style,i=e.length;if(void 0!==r[t])return t;for(var n=0;n<i;++n){var o="-"+e[n]+"-"+t;if(void 0!==r[o])return o}return""},n=(t.TRANSFORM=i(["webkit","ms","moz","o"],"transform"),t.FILTER=i(["webkit","ms","moz","o"],"filter"),t.ANIMATION=i(["webkit","ms","moz","o"],"animation"));t.KEYFRAMES=n.replace("animation","keyframes"),t.START_ANIMATION="startAnimation"}])});