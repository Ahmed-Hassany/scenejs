/*!
 * Copyright (c) 2018 Daybrush
 * license: MIT
 * author: Daybrush
 * repository: https://github.com/daybrush/scenejs.git
 * @version 0.12.2
 */
!function(e,t){"object"==typeof exports&&"object"==typeof module?module.exports=t():"function"==typeof define&&define.amd?define("Scene",[],t):"object"==typeof exports?exports.Scene=t():e.Scene=t()}(window,function(){return function(e){var t={};function __webpack_require__(r){if(t[r])return t[r].exports;var n=t[r]={i:r,l:!1,exports:{}};return e[r].call(n.exports,n,n.exports,__webpack_require__),n.l=!0,n.exports}return __webpack_require__.m=e,__webpack_require__.c=t,__webpack_require__.d=function(e,t,r){__webpack_require__.o(e,t)||Object.defineProperty(e,t,{configurable:!1,enumerable:!0,get:r})},__webpack_require__.r=function(e){Object.defineProperty(e,"__esModule",{value:!0})},__webpack_require__.n=function(e){var t=e&&e.__esModule?function(){return e.default}:function(){return e};return __webpack_require__.d(t,"a",t),t},__webpack_require__.o=function(e,t){return Object.prototype.hasOwnProperty.call(e,t)},__webpack_require__.p="",__webpack_require__(__webpack_require__.s=0)}([function(e,t,r){"use strict";var n=_interopRequireDefault(r(1)),i=_interopRequireDefault(r(16)),o=_interopRequireDefault(r(18)),a=r(19),s=r(9),u=_interopRequireDefault(r(6)),f=_interopRequireDefault(r(3));function _interopRequireDefault(e){return e&&e.__esModule?e:{default:e}}n.default.LINEAR=s.LINEAR,n.default.EASE=s.EASE,n.default.EASE_IN=s.EASE_IN,n.default.EASE_OUT=s.EASE_OUT,n.default.EASE_IN_OUT=s.EASE_IN_OUT,n.default.cubicBezier=u.default,n.default.SceneItem=i.default,n.default.Frame=o.default,n.default.Animator=f.default,n.default.TRANSFORM=a.TRANSFORM,n.default.FILTER=a.FILTER,n.default.ANIMATION=a.ANIMATION,n.default.KEYFRAMES=a.KEYFRAMES,e.exports=n.default},function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var n=function(){function defineProperties(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,n.key,n)}}return function(e,t,r){return t&&defineProperties(e.prototype,t),r&&defineProperties(e,r),e}}(),i=function get(e,t,r){null===e&&(e=Function.prototype);var n=Object.getOwnPropertyDescriptor(e,t);if(void 0===n){var i=Object.getPrototypeOf(e);return null===i?void 0:get(i,t,r)}if("value"in n)return n.value;var o=n.get;return void 0!==o?o.call(r):void 0},o=_interopRequireDefault(r(2)),a=_interopRequireDefault(r(16)),s=r(19),u=r(9);function _interopRequireDefault(e){return e&&e.__esModule?e:{default:e}}var f=function(e){function Scene(){return function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,Scene),function(e,t){if(!e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!t||"object"!=typeof t&&"function"!=typeof t?e:t}(this,(Scene.__proto__||Object.getPrototypeOf(Scene)).apply(this,arguments))}return function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}(Scene,o.default),n(Scene,[{key:"newItem",value:function(e,t){if(this.items[e])return this.items[e];var r=new a.default;return this.setItem(e,r),r.setOptions(t),r}},{key:"setSelector",value:function(e){for(var t in e){var r=e[t],n=this.getItem(r);n&&n.setSelector(t)}return this}},{key:"load",value:function(e,t){if(i(Scene.prototype.__proto__||Object.getPrototypeOf(Scene.prototype),"load",this).call(this,e,t),!this.options.selector)return this;var r=void 0,n=void 0;for(r in e)"options"!==r&&(n=this.getItem(r))&&n.setSelector(r);return this}},{key:"exportCSS",value:function(){var e=this.items,t=this.getDuration();for(var r in t&&isFinite(t)||(t=0),e){e[r].exportCSS(t,this.state)}return this}},{key:"playCSS",value:function(){var e=this,t=!(arguments.length>0&&void 0!==arguments[0])||arguments[0],r=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};if(!s.ANIMATION||"running"===this.getPlayState())return this;t&&this.exportCSS();var n=this.items,i=void 0;for(var o in n){var a=n[o];a.playCSS(!1,r),a._animationend&&(i=a)}return i?(this._animationend=function(t){e.end()},this._animationiteration=function(t){var r=t.currentTime,n=t.iterationCount;e.state.currentTime=r,e.setCurrentIterationCount(n)},this._animationItem=i,i.on("ended",this._animationend),i.on("iteration",this._animationiteration),this.setPlayState("running"),this):this}},{key:"end",value:function(){i(Scene.prototype.__proto__||Object.getPrototypeOf(Scene.prototype),"end",this).call(this);var e=this._animationItem;return e?(e.off("ended",this._animationend),e.off("iteration",this._animationiteration),this._animationItem=null,this._animationend=null,this._animationiteration=null,this):this}}]),Scene}();u.SCENE_ROLES.transform=!0,u.SCENE_ROLES.filter=!0,f.VERSION="0.12.2",t.default=f},function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var n=function(){function defineProperties(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,n.key,n)}}return function(e,t,r){return t&&defineProperties(e.prototype,t),r&&defineProperties(e,r),e}}(),i=_interopRequireDefault(r(3)),o=_interopRequireDefault(r(7)),a=r(5);function _interopRequireDefault(e){return e&&e.__esModule?e:{default:e}}var s=function(e){function Scene(e,t){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,Scene);var r=function(e,t){if(!e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!t||"object"!=typeof t&&"function"!=typeof t?e:t}(this,(Scene.__proto__||Object.getPrototypeOf(Scene)).call(this));return r.items={},r.load(e,t),r}return function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}(Scene,i.default),n(Scene,[{key:"getDuration",value:function(){var e=this.items,t=0;for(var r in e){var n=e[r];t=Math.max(t,n.getTotalDuration()/n.getPlaySpeed())}return t}},{key:"setDuration",value:function(e){var t=this.items,r=this.getDuration();if(!isFinite(r))return this;var n=e/r;for(var i in t){var o=t[i];o.setDelay(o.getDelay()*n),o.setDuration(o.getDuration()*n)}return this}},{key:"getItem",value:function(e){return this.items[e]}},{key:"newItem",value:function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};if((0,a.has)(this.items,e))return this.items[e];var r=new o.default;return this.setItem(e,r),r.setOptions(t),r}},{key:"setItem",value:function(e,t){return t.setId(e),this.items[e]=t,this}},{key:"setIterationTime",value:function(e){(function get(e,t,r){null===e&&(e=Function.prototype);var n=Object.getOwnPropertyDescriptor(e,t);if(void 0===n){var i=Object.getPrototypeOf(e);return null===i?void 0:get(i,t,r)}if("value"in n)return n.value;var o=n.get;return void 0!==o?o.call(r):void 0})(Scene.prototype.__proto__||Object.getPrototypeOf(Scene.prototype),"setIterationTime",this).call(this,e);var t=this.getIterationTime(),r=this.items,n=this.state.easing;for(var i in r){var o=r[i];o.setTime(t*o.state.playSpeed,n,this)}return this}},{key:"load",value:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:e.options;for(var r in e)if("options"!==r){var n=e[r];if(n instanceof o.default)this.setItem(r,n);else this.newItem(r).load(n)}return this.setOptions(t),this}},{key:"forEach",value:function(e){var t=this.items;for(var r in t)e(t[r],r,t)}}]),Scene}();t.default=s},function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var n=function(){function defineProperties(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,n.key,n)}}return function(e,t,r){return t&&defineProperties(e.prototype,t),r&&defineProperties(e,r),e}}(),i=_interopRequireDefault(r(4)),o=_interopRequireDefault(r(6)),a=r(5);function _interopRequireDefault(e){return e&&e.__esModule?e:{default:e}}var s=0,u=window.requestAnimationFrame||window.webkitRequestAnimationFrame||window.mozRequestAnimationFrame||function(e){var t=Date.now(),r=Math.max(0,16-(t-s)),n=window.setTimeout(function(){e(t+r)},1e3/60);return s=t+r,n},f=function(e){function Animator(e){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,Animator);var t=function(e,t){if(!e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!t||"object"!=typeof t&&"function"!=typeof t?e:t}(this,(Animator.__proto__||Object.getPrototypeOf(Animator)).call(this));return t._timer=0,t.options={},t.state={easing:0,easingName:"linear",iterationCount:1,delay:0,fillMode:"forwards",direction:"normal",playSpeed:1,currentTime:0,currentIterationTime:-1,currentIterationCount:0,prevTime:0,playState:"paused",duration:0},t.setOptions(e),t}return function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}(Animator,i.default),n(Animator,[{key:"setEasing",value:function(e){return Array.isArray(e)?(this.state.easingName="cubic-bezier("+e.join(",")+")",this.state.easing=o.default.apply(void 0,function(e){if(Array.isArray(e)){for(var t=0,r=Array(e.length);t<e.length;t++)r[t]=e[t];return r}return Array.from(e)}(e))):(this.state.easing=e,this.state.easingName=e.easingName||"linear"),this}},{key:"setOptions",value:function(e){if(!e)return this;for(var t in e){var r=e[t];"easing"!==t?"duration"!==t?(t in this.state?this.state:this.options)[t]=r:r&&this.setDuration(r):this.setEasing(r)}return this}},{key:"setCurrentIterationCount",value:function(e){var t=parseInt(e,10);this.state.currentIterationCount<t&&this.trigger("iteration",{currentTime:this.state.currentTime,iterationCount:t}),this.state.currentIterationCount=e}},{key:"getTotalDuration",value:function(){return"infinite"===this.state.iterationCount?1/0:this.state.delay+this.getActiveDuration()}},{key:"getActiveDuration",value:function(){return"infinite"===this.state.iterationCount?1/0:this.getDuration()*this.state.iterationCount}},{key:"isEnded",value:function(){return 0===this.getTime()&&"paused"===this.state.playState||!(this.getTime()<this.getTotalDuration())}},{key:"isPaused",value:function(){return"paused"===this.state.playState}},{key:"setNext",value:function(e){return this.on("ended",function(){e.play()}),this}},{key:"play",value:function(){var e=this;return this.isEnded()&&this.setTime(0),this.state.playState="running",u(function(t){e.state.prevTime=t,e.tick(t)}),this.trigger("play"),this}},{key:"pause",value:function(){return this.state.playState="paused",this.trigger("paused"),this}},{key:"end",value:function(){this.pause(),this.trigger("ended")}},{key:"reset",value:function(){return this.setTime(0),this.pause(),this}},{key:"setTime",value:function(e){var t=this.getTotalDuration(),r=e;return r<0?r=0:r>t&&(r=t),this.state.currentTime=r,this.calculateIterationTime(),this.trigger("timeupdate",{currentTime:r,time:this.getIterationTime(),iterationCount:this.getIterationCount()}),this}},{key:"getTime",value:function(){return this.state.currentTime}},{key:"getActiveTime",value:function(){return parseInt(1e4*Math.max(this.state.currentTime-this.state.delay,0),10)/1e4}},{key:"calculateIterationTime",value:function(){var e=this.state,t=e.iterationCount,r=e.fillMode,n=e.direction,i=this.getDuration(),o=this.getActiveTime(),a=this.state.currentTime-this.state.delay<0,s=0===i?0:o/i,u=s%2>=1,f=i?o%i:0,l=!1;if(a)return this.setIterationTime(0),this;switch(this.setCurrentIterationCount(s),n){case"reverse":f=i-f;break;case"alternate":u&&(f=i-f),l=!0;break;case"alternate-reverse":u||(f=i-f),l=!0}switch(r){case"both":case"forwards":if(l||s!==t||t%1!=0)break;f=i-f;break;default:if(s!==t||t%1!=0)break;f=0}return this.setIterationTime(f),this}},{key:"caculateEasing",value:function(e){if(!this.state.easing)return e;var t=this.getDuration();return(0,this.state.easing)(0===t?0:e/t)*e}},{key:"getIterationTime",value:function(){return this.state.currentIterationTime}},{key:"setIterationTime",value:function(e){var t=e;return this.state.currentIterationTime=t,this}},{key:"tick",value:function(e){var t=this,r=this.state.playSpeed,n=this.state.prevTime,i=this.getTime()+Math.min(1e3,e*r-n)/1e3;this.state.prevTime=e*r,this.setTime(i),this.isEnded()&&this.end(),"paused"!==this.state.playState&&u(function(e){t.tick(e)})}}]),Animator}(),l=f.prototype;(0,a.defineGetterSetter)(l,"delay","state"),(0,a.defineGetterSetter)(l,"fillMode","state"),(0,a.defineGetterSetter)(l,"iterationCount","state"),(0,a.defineGetterSetter)(l,"direction","state"),(0,a.defineGetterSetter)(l,"playState","state"),(0,a.defineGetterSetter)(l,"playSpeed","state"),(0,a.defineGetterSetter)(l,"duration","state"),(0,a.defineGetter)(l,"easingName","state"),(0,a.defineGetter)(l,"easing","state"),t.default=f},function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var n=function(){function defineProperties(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,n.key,n)}}return function(e,t,r){return t&&defineProperties(e.prototype,t),r&&defineProperties(e,r),e}}(),i=r(5);var o=function(){function EventTrigger(){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,EventTrigger),this._events={}}return n(EventTrigger,[{key:"on",value:function(e,t){var r=this._events,n=void 0,o=void 0;if((0,i.isObject)(e)){for(n in e)this.on(n,e[n]);return this}if((0,i.has)(r,e)||(r[e]=[]),(0,i.isObject)(t)){for(o in t)this.on(e,t[o]);return this}return t?(r[e].push(t),this):this}},{key:"off",value:function(e,t){if(e)if(t){var r=this._events[e];if(!r)return this;var n=r.indexOf(t);-1!==n&&r.splice(n,1)}else this._events[e]=[];else this._events={};return this}},{key:"trigger",value:function(e){for(var t=this,r=arguments.length,n=Array(r>1?r-1:0),o=1;o<r;o++)n[o-1]=arguments[o];var a=this._events;if(!(0,i.has)(a,e))return this;var s=a[e];if(n.length){var u=n[0];u.type=e,u.currentTarget=this,!u.target&&(u.target=this)}return s.forEach(function(e){e.apply(t,n)}),this}}]),EventTrigger}();o.defaultEvents={},t.default=o},function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var n="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},i=(t.isPercent=function(e){return~e.search(/([0-9]|\.|-|e-|e\+)+%/g)},t.isUndefined=function(e){return void 0===e},t.isObject=function(e){return"object"===(void 0===e?"undefined":n(e))},t.isArray=function(e){return Array.isArray(e)},t.isString=function(e){return"string"==typeof e},t.has=function(e,t){return Object.prototype.hasOwnProperty.call(e,t)},t.splitUnit=function(e){var t=""+e;try{var r=t.match(/([0-9]|\.|-|e-|e\+)+/g,"")[0];return{unit:t.replace(r,"")||"",value:r=parseFloat(r)}}catch(e){return{unit:t}}},t.camelize=function(e){return e.replace(/[\s-_]([a-z])/g,function(e,t){return t.toUpperCase()})}),o=t.defineGetter=function(e,t,r){e[i("get "+t)]=function(){return(r?this[r]:this)[t]}},a=t.defineSetter=function(e,t,r){e[i("set "+t)]=function(e){return r?this[r][t]=e:this[t]=e,this}};t.defineGetterSetter=function(e,t,r){o(e,t,r),a(e,t,r)},t.fill=function(e,t){for(var r=e.length,n=0;n<r;++n)e[n]=t;return e}},function(e,t,r){"use strict";function cubic(e,t,r){var n=1-r;return r*r*r+3*r*r*n*t+3*r*n*n*e}Object.defineProperty(t,"__esModule",{value:!0}),t.default=function(e,t,r,n){var i=function(i){var o=function(e,t,r){var n=r,i=r,o=1;for(;Math.abs(o)>.001;){if(i=cubic(e,t,n),o=i-r,Math.abs(o)<.001)return n;n-=o/2}return n}(e,r,Math.max(Math.min(1,i),0));return cubic(t,n,o)};return i.easingName="cubic-bezier("+e+", "+t+", "+r+", "+n+")",i}},function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var n=function(){function defineProperties(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,n.key,n)}}return function(e,t,r){return t&&defineProperties(e.prototype,t),r&&defineProperties(e,r),e}}(),i=function get(e,t,r){null===e&&(e=Function.prototype);var n=Object.getOwnPropertyDescriptor(e,t);if(void 0===n){var i=Object.getPrototypeOf(e);return null===i?void 0:get(i,t,r)}if("value"in n)return n.value;var o=n.get;return void 0!==o?o.call(r):void 0},o=_interopRequireDefault(r(3)),a=_interopRequireDefault(r(8)),s=r(5),u=_interopRequireDefault(r(13)),f=r(15);function _interopRequireDefault(e){return e&&e.__esModule?e:{default:e}}var l=function(e){function SceneItem(e,t){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,SceneItem);var r=function(e,t){if(!e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!t||"object"!=typeof t&&"function"!=typeof t?e:t}(this,(SceneItem.__proto__||Object.getPrototypeOf(SceneItem)).call(this));return r.timeline=new u.default,r.load(e,t),r}return function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}(SceneItem,o.default),n(SceneItem,[{key:"getDuration",value:function(){return Math.max(this.state.duration,this.timeline.getLastTime())}},{key:"setDuration",value:function(e){var t=e/this.getDuration(),r=this.timeline,n=r.times,o=r.items,a={};r.times=n.map(function(e){var r=e*t;return a[r]=o[e],r}),r.items=a,i(SceneItem.prototype.__proto__||Object.getPrototypeOf(SceneItem.prototype),"setDuration",this).call(this,e)}},{key:"setId",value:function(e){this.state.id=e}},{key:"getId",value:function(){return this.state.id}},{key:"set",value:function(e,t,r,n){var i=this;if((0,s.isArray)(e))return e.forEach(function(e){i.set(e,t,r,n)}),this;if((0,s.isObject)(e))return this.load(e),this;var o=this.getFrame(e)||this.newFrame(e);return o.set(t,r,n),this.updateFrame(o),this}},{key:"get",value:function(e,t,r){var n=this.getFrame(e);return n&&n.get(t,r)}},{key:"remove",value:function(e,t,r){var n=this.getFrame(e);return n&&n.remove(t,r),this}},{key:"animate",value:function(e,t,r){var n=this.getIterationTime(),i=this.getEasing()||t,o=this.getNowFrame(n,i);if(!o)return o;var a=this.getTime();return this.trigger("animate",{frame:o,currentTime:a,time:n}),r&&r.trigger("animate",{frame:o,currentTime:a,target:this,time:n}),o}},{key:"setTime",value:function(e,t,r){return i(SceneItem.prototype.__proto__||Object.getPrototypeOf(SceneItem.prototype),"setTime",this).call(this,e),this.animate(e,t,r),this}},{key:"update",value:function(){return this.timeline.update(),this}},{key:"updateFrame",value:function(e){return this.timeline.updateFrame(e),this}},{key:"newFrame",value:function(e){var t=this.getFrame(e);return t||(t=new a.default,(0,s.isUndefined)(e)||this.setFrame(e,t),t)}},{key:"setFrame",value:function(e,t){return this.timeline.add(e,t),this.timeline.update(),this}},{key:"_getTime",value:function(e){var t=(arguments.length>1&&void 0!==arguments[1]?arguments[1]:{}).duration||this.getDuration()||100;if((0,s.isString)(e)){if((0,s.isPercent)(e))return!this.getDuration()&&(this.state.duration=t),parseFloat(e)/100*t;if("from"===e)return 0;if("to"===e)return t}return parseFloat(e)}},{key:"getFrame",value:function(e){return this.timeline.get(this._getTime(e))}},{key:"hasFrame",value:function(e){return this.timeline.has(e)}},{key:"removeFrame",value:function(e){var t=this.timeline;return t.remove(e),t.update(),this}},{key:"copyFrame",value:function(e,t){if((0,s.isObject)(e)){for(var r in e)this.copyFrame(r,e[r]);return this}var n=this.getFrame(e);if(!n)return this;var i=n.clone();return this.setFrame(t,i),this}},{key:"mergeFrame",value:function(e,t){if((0,s.isObject)(e)){for(var r in e)this.mergeFrame(r,e[r]);return this}var n=this.getFrame(e);return n?(this.newFrame(t).merge(n),this):this}},{key:"getNowValue",value:function(e,t,r){var n=arguments.length>3&&void 0!==arguments[3]?arguments[3]:this.timeline.size(),i=arguments.length>4&&void 0!==arguments[4]?arguments[4]:0,o=arguments.length>5&&void 0!==arguments[5]?arguments[5]:this.state.easing,a=this.timeline,u=a.times,l=u.length,c=u[n],h=u[i],p=a.get(c),v=a.get(h);if(r>=c)for(var d=n;d>=0&&(c=u[d],!(p=a.get(c)).has(e,t));--d);for(var m=i;m<l&&(h=u[m],!(v=a.get(h)).has(e,t));++m);var y=p&&p.get(e,t),_=v&&v.get(e,t);if((0,s.isUndefined)(y))return _;if((0,s.isUndefined)(_)||y===_)return y;c<0&&(c=0);var g=u[n],b=u[i],O=this.state.easing||o;return(0,f.dotValue)({time:r,prevTime:c,nextTime:h,startTime:g,endTime:b,prevValue:y,nextValue:_,easing:O})}},{key:"getNearIndex",value:function(e){var t=this.timeline,r=t.times,n=t.getLastTime(),i=t.size();if(0!==i){var o=parseInt(n>0?e*i/n:0,10),a=i-1,s=0;if(o<0?o=0:o>a&&(o=a),e<r[a])for(;s<a;){if((s===o||a===o)&&s+1===a){e<r[s]&&(a=s);break}if(r[o]>e)a=o;else{if(!(r[o]<e)){s=a=o;break}s=o}o=parseInt((s+a)/2,10)}else s=o=a;return{left:s,right:a}}}},{key:"getNowFrame",value:function(e,t){var r=this.getNearIndex(e);if(!r)return r;var n=r.left,i=r.right,o=this.newFrame(),a=this.timeline.names;for(var u in a){var f=a[u];for(var l in f){var c=this.getNowValue(u,l,e,n,i,t);(0,s.isUndefined)(c)||o.set(u,l,c)}}return o}},{key:"load",value:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:e.options;if(this.setOptions(t),(0,s.isArray)(e)){for(var r=e.length,n=0;n<r;++n){var i=1===r?0:this._getTime(n/(r-1)*100+"%",t);this.set(i,e[n])}return this}for(var o in e)if("options"!==o){var a=e[o],u=this._getTime(o);"number"!=typeof a?this.set(u,e[o]):this.mergeFrame(a,u)}return this}},{key:"clone",value:function(){var e=this,t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},r=new this.constructor,n=this.timeline.times;return r.setOptions(this.state),r.setOptions(t),n.forEach(function(t){return r.setFrame(t,e.getFrame(t).clone())}),r}}]),SceneItem}();t.default=l},function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var n,i=function(){function defineProperties(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,n.key,n)}}return function(e,t,r){return t&&defineProperties(e.prototype,t),r&&defineProperties(e,r),e}}(),o=r(9),a=r(5),s=r(10),u=r(11),f=(n=u)&&n.__esModule?n:{default:n};function isPropertyObject(e){return e instanceof f.default}function clone(e){return _merge({},e,arguments.length>1&&void 0!==arguments[1]&&arguments[1])}function _merge(e,t){var r=arguments.length>2&&void 0!==arguments[2]&&arguments[2];for(var n in t){var i=t[n];(0,a.isObject)(i)?i instanceof f.default?e[n]=r?i.toValue():i.clone():(0,a.isArray)(i)?e[n]=i.slice():!(0,a.isObject)(e[n])||e[n]instanceof f.default?e[n]=clone(i,r):_merge(e[n],i,r):e[n]=t[n]}return e}var l=function(){function Frame(e){for(var t in function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,Frame),this.properties={},o.SCENE_ROLES)this.properties[t]={};this.load(e)}return i(Frame,[{key:"load",value:function(e){if(e&&!(0,a.isObject)(e))return this;for(var t in e){var r=e[t];(0,a.has)(o.SCENE_ROLES,t)?this.set(t,r):!(0,a.isObject)(r)||(0,a.isArray)(r)||isPropertyObject(r)?this._set(o.PROPERTY,t,r):this.set(t,r)}return this}},{key:"get",value:function(e,t){var r=this.properties;return t?r[e]&&r[e][t]:e in o.SCENE_ROLES?r[e]:r[o.PROPERTY][e]}},{key:"remove",value:function(e,t){return t?delete this.properties[e][t]:e in o.SCENE_ROLES?delete this.properties[e]:delete this.properties[o.PROPERTY][e],this}},{key:"_set",value:function(e,t,r){var n=e.trim(),i=this.properties;!(n in i)&&(i[n]={}),i[n][t]=(0,a.isString)(r)?(0,s.toPropertyObject)(r):r}},{key:"set",value:function(e,t,r){var n=this;if((0,a.isObject)(e))return this.load(e),this;if((0,a.isUndefined)(t)){for(var i=e.split(";"),o=i.length,u=0;u<o;++u){var f=/([^:]*):([\S\s]*)/g.exec(i[u]);!f||f.length<3||!f[1]||this.set(f[1].trim(),f[2])}return this}if((0,a.isObject)(t)){for(var l in t)this._set(e,l,t[l]);return this}if((0,a.isUndefined)(r)){if((0,a.isString)(t)){var c=(0,s.splitSpace)(t).map(function(e){return(0,s.toPropertyObject)(e)});if(c.every(function(e){return e.model&&"color"!==e.type}))return c.forEach(function(t){var r=t.model;t.model="",t.prefix="",t.suffix="",n._set(e,r,1===t.size()?t.get(0):t)}),this}return this._set("property",e,t),this}return this._set(e,t,r),this}},{key:"has",value:function(e,t){return this.properties[e]&&(0,a.has)(this.properties[e],t)}},{key:"clone",value:function(){var e=new this.constructor;return e.merge(this),e}},{key:"merge",value:function(e){var t=this.properties,r=e.properties;return r?(_merge(t,r),this):this}},{key:"toObject",value:function(){return clone(this.properties,!0)}}]),Frame}();t.default=l},function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.EASE_IN_OUT=t.EASE_OUT=t.EASE_IN=t.EASE=t.LINEAR=t.PLAY_DIRECTION=t.FILL_MODE=t.ANIMATION_PLAY_STATE=t.SCENE_ROLES=t.PROPERTY=t.PREFIX=void 0;var n,i=r(6),o=(n=i)&&n.__esModule?n:{default:n};t.PREFIX="__SCENEJS_";var a=t.PROPERTY="property";t.SCENE_ROLES=function(e,t,r){return t in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}({},a,!0),t.ANIMATION_PLAY_STATE=["idle","pending","paused","running","finished"],t.FILL_MODE=["none","forwards","backwards","both","auto"],t.PLAY_DIRECTION=["normal","reverse","alternate","alternate-reverse"],t.LINEAR=(0,o.default)(0,0,1,1),t.EASE=(0,o.default)(.25,.1,.25,1),t.EASE_IN=(0,o.default)(.42,0,1,1),t.EASE_OUT=(0,o.default)(0,0,.58,1),t.EASE_IN_OUT=(0,o.default)(.42,0,.58,1)},function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.stringToColorObject=t.toPropertyObject=t.arrayToPropertyObject=t.toBracketObject=t.toColorObject=t.arrayToColorObject=t.splitComma=t.splitSpace=void 0;var n,i=r(11),o=(n=i)&&n.__esModule?n:{default:n},a=r(12),s=r(5);var u=void 0,f=void 0,l=t.splitSpace=function(e){for(var t=e.split(/("[^"]*"|'[^']*'|[^\s()]*(?:\((?:[^()]*|\([^()]*\))*\))[^\s()]*)|\s+/g),r=t.length,n=[],i=0,o=0;o<r;++o){var a=t[o];if((0,s.isUndefined)(a))n[i]&&++i;else if(a){var u=n[i];n[i]=u?u+a:a}}return n},c=t.splitComma=function(e){for(var t=e.split(/("[^"]*"|'[^']*'|[^,\s()]*(?:\((?:[^()]*|\([^()]*\))*\))[^,\s()]*)|\s*,\s*/g),r=t.length,n=[],i=0,o=0;o<r;++o){var a=t[o];if((0,s.isUndefined)(a))n[i]&&++i;else if(a){var u=n[i];n[i]=u?u+a:a}}return n},h=t.arrayToColorObject=function(e){return e instanceof o.default?(e.type="color",e.model="rgba",e.prefix="rgba(",e.suffix=")",e):(3===e.length&&(e[3]=1),new o.default(e,{model:"rgba",separator:",",type:"color",prefix:"rgba(",suffix:")"}))},p=t.toColorObject=function(e){var t=void 0;if(e instanceof o.default)t=e;else if((0,s.isObject)(e))t=h(e);else if((0,s.isString)(e))return f(e);var r=t.value,n=r.length;4===n?r[3]=parseFloat(r[3]):3===n&&(r[3]=1),t.type="color";var i=t.model.toLowerCase(),u=void 0;switch("rgb"===i&&h(t),i){case"rgb":case"rgba":for(u=0;u<3;++u)r[u]=parseInt(r[u],10);break;case"hsl":case"hsla":for(u=1;u<3;++u)-1!==r[u].indexOf("%")&&(r[u]=parseFloat(r[u])/100);return r=(0,a.hslToRGB)(r),h(r)}return t},v=t.toBracketObject=function(e){var t=/([^(]*)\(([\s\S]*)\)([\s\S]*)/g.exec(e);if(!t||t.length<4)return e;var r=t[1]||"",n=r+"(",i=t[2],a=")"+t[3],s=c(i),f=void 0,l=",";return 1===s.length&&((f=u(i)).prefix||f.suffix||(l=f.separator,f=f.value)),f||(f=s.map(function(e){return u(e)})),new o.default(f,{separator:l,model:r,prefix:n,suffix:a})},d=t.arrayToPropertyObject=function(e){return new o.default(e,{type:"array"})};t.stringToColorObject=f=function(e){var t=0,r=0;if("#"===e.charAt(0))return t=4===e.length?(0,a.hexToRGB)((0,a.hex3to6)(e)):(e.length,(0,a.hexToRGB)(e)),h(t);if(-1===e.indexOf("("))throw new Error("Invalid Format : Not a Color - "+e);return r=v(e),p(r)},t.toPropertyObject=u=function(e){if(!(0,s.isString)(e))return Array.isArray(e)?d(e):e;var t=c(e),r=void 0;if(t.length>1)return(r=new o.default(t.map(function(e){return u(e)}),",")).type="array",r;if((t=l(e)).length>1)return(r=new o.default(t.map(function(e){return u(e)})," ")).type="array",r;if((r=e.charAt(0))&&('"'===r||"'"===r))return e;if(-1!==e.indexOf("(")){if(r=v(e),!(0,s.isObject)(r))return r;var n=r.model.toLowerCase();if(-1!==a.COLOR_MODELS.indexOf(n))return p(r);for(var i=r.length,f=0;f<i;++f)r.set(f,u(r.get(f)));return r}return 0===e.indexOf("#")?p(e):e},t.toPropertyObject=u,t.stringToColorObject=f},function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var n=function(){function defineProperties(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,n.key,n)}}return function(e,t,r){return t&&defineProperties(e.prototype,t),r&&defineProperties(e,r),e}}(),i=r(5);var o=function(){function PropertyObject(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:",";!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,PropertyObject),this.prefix="",this.suffix="",this.model="",this.type="",this.separator=",",this.init(e,t)}return n(PropertyObject,[{key:"init",value:function(e,t){var r=void 0;if((0,i.isObject)(t))for(r in t)this[r]=t[r];else this.separator=t;(0,i.isString)(e)?this.value=e.split(this.separator):(0,i.isObject)(e)?this.value=e:this.value=[e]}},{key:"size",value:function(){return this.value.length}},{key:"get",value:function(e){return this.value[e]}},{key:"set",value:function(e,t){return this.value[e]=t,this}},{key:"clone",value:function(){return new PropertyObject(this.value.map(function(e){return e instanceof PropertyObject?e.clone():e}),{separator:this.separator,prefix:this.prefix,suffix:this.suffix,model:this.model,type:this.type})}},{key:"toValue",value:function(){return this.prefix+this.join()+this.suffix}},{key:"join",value:function(){var e=this.separator;return this.value.map(function(e){return e instanceof PropertyObject?e.toValue():e}).join(e)}},{key:"forEach",value:function(e){return this.value.forEach(e),this}}]),PropertyObject}();t.default=o},function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0});t.COLOR_MODELS=["rgb","rgba","hsl","hsla"];var n=t.cutHex=function(e){return"#"===e.charAt(0)?e.substring(1):e};t.hexToRGB=function(e){var t=n(e),r=parseInt(t.substring(0,2),16),i=parseInt(t.substring(2,4),16),o=parseInt(t.substring(4,6),16),a=parseInt(t.substring(6,8),16)/255;return isNaN(a)&&(a=1),[r,i,o,a]},t.hex3to6=function(e){var t=e.charAt(1),r=e.charAt(2),n=e.charAt(3);return["#",t,t,r,r,n,n].join("")},t.hslToRGB=function(e){var t=e[0],r=e[1],n=e[2];t<0&&(t+=360*parseInt((Math.abs(t)+360)/360,10)),t%=360;var i=(1-Math.abs(2*n-1))*r,o=i*(1-Math.abs(t/60%2-1)),a=n-i/2,s=void 0;t<60?s=[i,o,0]:t<120?s=[o,i,0]:t<180?s=[0,i,o]:t<240?s=[0,o,i]:t<300?s=[o,0,i]:t<360&&(s=[i,0,o]);var u=[Math.round(255*(s[0]+a)),Math.round(255*(s[1]+a)),Math.round(255*(s[2]+a))];return e.length>3&&(u[3]=e[3]),u}},function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var n,i=function(){function defineProperties(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,n.key,n)}}return function(e,t,r){return t&&defineProperties(e.prototype,t),r&&defineProperties(e,r),e}}(),o=r(14),a=(n=o)&&n.__esModule?n:{default:n};var s=function(e){function FrameTimeline(){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,FrameTimeline);var e=function(e,t){if(!e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!t||"object"!=typeof t&&"function"!=typeof t?e:t}(this,(FrameTimeline.__proto__||Object.getPrototypeOf(FrameTimeline)).call(this));return e.names={},e}return function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}(FrameTimeline,a.default),i(FrameTimeline,[{key:"hasName",value:function(e,t){var r=this.names;return e in r&&r[e]&&t in r[e]}},{key:"update",value:function(){var e=this.items;for(var t in e)this.updateFrame(e[t]);return this}},{key:"updateFrame",value:function(e){if(!e)return this;var t=e.properties,r=this.names;for(var n in t){r[n]=r[n]||{};var i=t[n];for(var o in i)r[n][o]=!0}return this}}]),FrameTimeline}();t.default=s},function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var n=function(){function defineProperties(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,n.key,n)}}return function(e,t,r){return t&&defineProperties(e.prototype,t),r&&defineProperties(e,r),e}}(),i=r(5);var o=function(){function Timeline(){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,Timeline),this.times=[],this.items={}}return n(Timeline,[{key:"getLastTime",value:function(){var e=this.times;return 0===e.length?0:e[e.length-1]}},{key:"size",value:function(){return this.times.length}},{key:"add",value:function(e,t){return this.items[e]=t,this.addTime(e),this}},{key:"addTime",value:function(e){var t=this.times,r=t.length,n=r,i=void 0;for(i=0;i<r;++i){if(e===t[i])return this;if(e<t[i]){n=i;break}}return this.times.splice(n,0,e),this}},{key:"has",value:function(e){return(0,i.has)(this.items,e)}},{key:"get",value:function(e){return this.items[e]}},{key:"remove",value:function(e){return delete this.items[e],this.removeTime(e),this}},{key:"removeTime",value:function(e){var t=this.times.indexOf(e);return-1===t?this:(this.times.splice(t,1),this)}}]),Timeline}();t.default=o},function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.dot=t.dotValue=t.dotObject=t.dotColor=t.dotArray=void 0;var n,i=r(5),o=r(11),a=(n=o)&&n.__esModule?n:{default:n},s=r(10);var u=void 0,f=t.dotArray=function(e,t,r,n){if(0===n)return t;if(!(0,i.isArray)(t))return e;var o=t.length;return e.map(function(e,i){return i>=o?e:u(e,t[i],r,n)})},l=t.dotColor=function(e,t,r,n){var i=e,o=t;i instanceof a.default||(i=(0,s.toColorObject)(i)),o instanceof a.default||(o=(0,s.toColorObject)(o));var l=i.value,c=o.value,h=i.model;if(h!==o.model)return u(i.toValue(),o.toValue(),r,n);3===l.length&&(l[3]=1),3===c.length&&(c[3]=1);for(var p=f(l,c,r,n),v=h,d=0;d<3;++d)p[d]=parseInt(p[d],10);return new a.default(p,{type:"color",model:v,prefix:v+"(",suffix:")"})},c=t.dotObject=function(e,t,r,n){var o=e.type;if("color"===o)return l(e,t,r,n);var s=e.value,u=t.value;if(!(0,i.isObject)(t))return e;var c=f(s,u,r,n);return new a.default(c,{type:o,separator:e.separator||t.separator,prefix:e.prefix||t.prefix,suffix:e.suffix||t.suffix,model:e.model||t.model})};t.dot=u=function(e,t,r,n){if(e instanceof a.default)return c(e,t,r,n);if((0,i.isArray)(e))return f(e,t,r,n);if(r+n===0)return e;var o=(0,i.splitUnit)(e),s=(0,i.splitUnit)(t),u=r/(r+n),l=1-u,h=void 0;if(isNaN(o.value)||isNaN(s.value))return u>=1?t:e;h=o.value*l+s.value*u;var p=o.unit||s.unit||!1;return!1===p?h:h+p.trim()};t.dotValue=function(e){var t=e.time,r=e.prevTime,n=e.nextTime,i=e.startTime,o=void 0===i?r:i,a=e.endTime,s=void 0===a?n:a,f=e.prevValue,l=e.nextValue,c=e.easing;if(!c||o===s)return u(f,l,t-r,n-t);var h=u(f,l,o-r,n-o),p=u(f,l,s-r,n-s),v=c((t-o)/(s-o));return u(h,p,v,1-v)};t.dot=u},function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var n=function(){function defineProperties(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,n.key,n)}}return function(e,t,r){return t&&defineProperties(e.prototype,t),r&&defineProperties(e,r),e}}(),i=function get(e,t,r){null===e&&(e=Function.prototype);var n=Object.getOwnPropertyDescriptor(e,t);if(void 0===n){var i=Object.getPrototypeOf(e);return null===i?void 0:get(i,t,r)}if("value"in n)return n.value;var o=n.get;return void 0!==o?o.call(r):void 0},o=_interopRequireDefault(r(7)),a=r(9),s=r(17),u=_interopRequireDefault(r(18)),f=r(19);function _interopRequireDefault(e){return e&&e.__esModule?e:{default:e}}var l={fillMode:"fill-mode",name:"name",delay:"delay",iterationCount:"iteration-count",easing:"timing-function",direction:"direction",duration:"duration",playState:"play-state"};function makeId(){for(;;){var e=""+parseInt(1e5*Math.random(),10);if(!document.querySelector('[data-scene-id="'+e+'"]'))return e}}function makeAnimationProperties(e){var t=[];for(var r in e)t.push(f.ANIMATION+"-"+(l[r]||r)+" : "+e[r]+";");return t.join("")}var c=function(e){function SceneItem(){return function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,SceneItem),function(e,t){if(!e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!t||"object"!=typeof t&&"function"!=typeof t?e:t}(this,(SceneItem.__proto__||Object.getPrototypeOf(SceneItem)).apply(this,arguments))}return function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}(SceneItem,o.default),n(SceneItem,[{key:"newFrame",value:function(e){var t=this.getFrame(e);return t||(t=new u.default,void 0!==e&&this.setFrame(e,t),t)}},{key:"setId",value:function(e){var t=this._elements;i(SceneItem.prototype.__proto__||Object.getPrototypeOf(SceneItem.prototype),"setId",this).call(this,e);var r=(0,s.toId)(this.state.id);if(this.options.selector||(this.options.selector='[data-scene-id="'+r+'"]'),!t)return this;var n=t.length;if(!n)return this;for(var o=0;o<n;++o)t[o].setAttribute("data-scene-id",r);return this}},{key:"animate",value:function(e,t,r){var n=i(SceneItem.prototype.__proto__||Object.getPrototypeOf(SceneItem.prototype),"animate",this).call(this,e,t,r),o=this._elements;if(!o||!o.length)return n;var a=n.toCSS();if(this.state.cssText===a)return n;this.state.cssText=a;for(var s=o.length,u=0;u<s;++u)o[u].style.cssText+=a;return n}},{key:"setSelector",value:function(e){return this.options.selector=!0===e?this.state.id:e||'[data-scene-id="'+this.state.id+'"]',this.setElement(document.querySelectorAll(e)),this}},{key:"setElement",value:function(e){if(!e)return this;if("string"==typeof e)return this.setSelector(e);var t=this.state.id;return this._elements=e instanceof Element?[e]:e,this.setId(t&&"null"!==t?t:makeId()),this}},{key:"setCSS",value:function(e,t){return this.set(e,this.fromCSS(t)),this}},{key:"fromCSS",value:function(e){if(!e||!e.length)return{};var t=this._elements;if(!t||!t.length)return{};for(var r={},n=window.getComputedStyle(t[0]),i=e.length,o=0;o<i;++o)r[e[o]]=n[e[o]];return r}},{key:"setOptions",value:function(e){i(SceneItem.prototype.__proto__||Object.getPrototypeOf(SceneItem.prototype),"setOptions",this).call(this,e);var t=e&&e.selector,r=this.options.elements||this.options.element;return t||r?(r&&this.setElement(r),!0===t?this.setSelector(this.state.id):this.setSelector(t),this):this}},{key:"_toKeyframes",value:function(){var e=this,t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:this.getDuration(),r=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{},n=this.state.id||this.setId(makeId()).state.id;if(!n)return"";var i=this.getDuration(),o=this.timeline.times.slice(),u=this.state.playSpeed,l=void 0!==r.iterationCount,c=l&&this.state.delay||0,h=l&&this.state.direction,p=[],v=this.state.iterationCount;!this.getFrame(0)&&o.unshift(0),!this.getFrame(i)&&o.push(i);var d=o.length,m=o.map(function(t){return e.getNowFrame(t,!1).toCSS()});v=l&&"infinite"!==v?v:1;var y=!1,_=!1;"alternate-reverse"!==h&&"alternate"!==h||(y=!0),c&&(p.push("0%{"+m[0]+"}"),"revsere"!==h&&"alternate-reverse"!==h||p.push(c/u/t*100-1e-5+"%{"+m[0]+"}"));for(var g=0;g<v;++g){var b=g%2==0,O=c+g*i,S=!1;switch(h){case"reverse":S=!0;break;case"alternate":b||(S=!0);break;case"alternate-reverse":b&&(S=!0)}for(var T=0;T<d;++T){var k=S?d-1-T:T,E=m[k],I=o[k],P=(O+(S?i-I:I))/u/t*100;if(P>100)break;100===P&&(_=!0),0!==g&&0===T?y||p.push(P+1e-4+"%{"+E+"}"):p.push(P+"%{"+E+"}")}if(g+1>=v&&!_){var j=v%1,w=j?this.getNowFrame(i*(S?1-j:j)).toCSS():m[S?0:d-1];j&&p.push(v*i/u/t*100+"%{"+w+"}"),p.push("100%{"+w+"}")}}return"@"+f.KEYFRAMES+" "+a.PREFIX+"KEYFRAMES_"+(0,s.toId)(n)+"{\n\t\t\t"+p.join("\n")+"\n\t\t}"}},{key:"toCSS",value:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:this.getDuration(),t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{},r=this.state.id||this.setId(makeId()).state.id;if(!r)return"";var n=0===e,i=this.options.selector,o=t.playSpeed||1,u=((void 0===t.delay?this.state.delay:t.delay)||0)/o,l=!n&&t.easing&&t.easingName||this.state.easingName,c=!n&&t.iterationCount||this.state.iterationCount,h=makeAnimationProperties({fillMode:"forwards"!==t.fillMode&&t.fillMode||this.state.fillMode,direction:"none"!==t.direction&&t.direction||this.state.direction,delay:u+"s",name:a.PREFIX+"KEYFRAMES_"+(0,s.toId)(r),duration:e/o+"s",easing:l,iterationCount:c});return i+"."+f.START_ANIMATION+" {\n\t\t\t"+h+"\n\t\t}\n\t\t"+this._toKeyframes(e,t)}},{key:"exportCSS",value:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:this.getDuration(),t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{},r=(0,s.toId)(this.state.id||this.setId(makeId()).state.id||"");if(r){var n=document.querySelector("#"+a.PREFIX+r),i=this.toCSS(e,t);n?n.innerText=i:document.body.insertAdjacentHTML("beforeend",'<style id="'+a.PREFIX+"STYLE_"+r+'">'+i+"</style>")}}},{key:"playCSS",value:function(){var e=this,t=!(arguments.length>0&&void 0!==arguments[0])||arguments[0],r=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};if(!f.ANIMATION||"running"===this.getPlayState())return this;var n=this._elements;if(!n||!n.length)return this;this.isEnded()&&this.setTime(0),this.setPlayState("running"),t&&this.exportCSS();for(var i=n.length,o=makeAnimationProperties(r),a=0;a<i;++a){var u=n[a];u.style.cssText+=o,(0,s.hasClass)(u,f.START_ANIMATION)?((0,s.removeClass)(u,f.START_ANIMATION),function(e){requestAnimationFrame(function(){requestAnimationFrame(function(){(0,s.addClass)(e,f.START_ANIMATION)})})}(u)):(0,s.addClass)(u,f.START_ANIMATION)}this.setPlayState("running"),this.trigger("play");var l=this.getDuration();return this._animationend=function(t){e.end()},this._animationiteration=function(t){var r=t.elapsedTime,n=r/l;e.state.currentTime=r,e.setCurrentIterationCount(n)},n[0].addEventListener("animationend",this._animationend),n[0].addEventListener("animationiteration",this._animationiteration),this}},{key:"end",value:function(){i(SceneItem.prototype.__proto__||Object.getPrototypeOf(SceneItem.prototype),"end",this).call(this);var e=this._elements;return e&&e.length&&this._animationend?(e[0].removeEventListener("animationend",this._animationend),e[0].removeEventListener("animationiteration",this._animationiteration),this._animationend=null,this._animationiteration=null,this):this}}]),SceneItem}();t.default=c},function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0});t.toId=function(e){return e.match(/[0-9a-zA-Z]+/g).join("")},t.hasClass=function(e,t){return e.classList?e.classList.contains(t):!!e.className.match(new RegExp("(\\s|^)"+t+"(\\s|$)"))},t.addClass=function(e,t){e.classList?e.classList.add(t):e.className+=" "+t},t.removeClass=function(e,t){if(e.classList)e.classList.remove(t);else{var r=new RegExp("(\\s|^)"+t+"(\\s|$)");e.className=e.className.replace(r," ")}}},function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var n,i=function(){function defineProperties(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,n.key,n)}}return function(e,t,r){return t&&defineProperties(e.prototype,t),r&&defineProperties(e,r),e}}(),o=r(8),a=(n=o)&&n.__esModule?n:{default:n},s=r(19);function toInnerProperties(e){if(!e)return"";var t=[];for(var r in e)t.push(r+"("+e[r]+")");return t.join(" ")}var u=function(e){function Frame(){return function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,Frame),function(e,t){if(!e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!t||"object"!=typeof t&&"function"!=typeof t?e:t}(this,(Frame.__proto__||Object.getPrototypeOf(Frame)).apply(this,arguments))}return function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}(Frame,a.default),i(Frame,[{key:"toCSSObject",value:function(){var e=this.toObject(),t={},r=e.property;for(var n in r)t[n]=r[n];var i=toInnerProperties(e.transform),o=toInnerProperties(e.filter);return s.TRANSFORM&&i&&(t[s.TRANSFORM]=i),s.FILTER&&o&&(t[s.FILTER]=o),t}},{key:"toCSS",value:function(){var e=this.toCSSObject(),t=[];for(var r in e)t.push(r+":"+e[r]+";");return t.join("")}}]),Frame}();t.default=u},function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var n=function(e,t){var r=(document.body||document.documentElement).style,n=e.length;if(void 0!==r[t])return t;for(var i=0;i<n;++i){var o="-"+e[i]+"-"+t;if(void 0!==r[o])return o}return""},i=(t.TRANSFORM=n(["webkit","ms","moz","o"],"transform"),t.FILTER=n(["webkit","ms","moz","o"],"filter"),t.ANIMATION=n(["webkit","ms","moz","o"],"animation"));t.KEYFRAMES=i.replace("animation","keyframes"),t.START_ANIMATION="startAnimation"}])});